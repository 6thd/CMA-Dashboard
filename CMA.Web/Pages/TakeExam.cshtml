@page "{examId}"
@model CMA.Web.Pages.TakeExamModel
@{
    ViewData["Title"] = Model.Exam?.Title ?? "Take Exam";
}

@if (Model.Exam != null)
{
    <div class="p-6 max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold text-white mb-2">@Model.Exam.Title</h1>
        <p class="text-gray-300 mb-6">@Model.Exam.Description</p>

        @if (Model.CurrentQuestion != null && Model.Questions != null)
        {
            <div class="bg-gray-900/50 backdrop-blur-xl border border-white/10 p-6 rounded-lg">
                <h2 class="text-xl font-semibold text-white mb-4">Question @(Model.CurrentQuestionIndex + 1) of @Model.Questions!.Count</h2>
                <p class="text-white mb-6">@Model.CurrentQuestion.QuestionText</p>

                <form method="post">
                    <input type="hidden" asp-for="ExamId" />
                    <input type="hidden" asp-for="CurrentQuestionIndex" />
                    <div class="space-y-4">
                        @if (Model.CurrentQuestion.Options != null)
                        {
                            @foreach (var option in Model.CurrentQuestion.Options!)
                            {
                                <label class="flex items-center p-4 rounded-lg bg-white/10 hover:bg-white/20 cursor-pointer">
                                    <input type="radio" name="Answer" value="@option" class="form-radio h-5 w-5 text-blue-500" />
                                    <span class="ml-4 text-white">@option</span>
                                </label>
                            }
                        }
                    </div>

                    <div class="mt-6 flex justify-between items-center">
                        <button type="submit" asp-page-handler="Previous" disabled="@(Model.CurrentQuestionIndex == 0)" class="px-6 py-2 bg-gray-600 text-white rounded-lg disabled:opacity-50">
                            Previous
                        </button>
                        
                        @if (Model.CurrentQuestionIndex == Model.Questions.Count - 1)
                        {
                            <button type="submit" asp-page-handler="Submit" class="px-6 py-2 bg-green-600 text-white rounded-lg">
                                Submit
                            </button>
                        }
                        else
                        {
                            <button type="submit" asp-page-handler="Next" class="px-6 py-2 bg-blue-600 text-white rounded-lg">
                                Next
                            </button>
                        }
                    </div>
                </form>
            </div>
        }
        else
        {
            <div class="text-center p-8 text-white">No questions found for this exam.</div>
        }
    </div>
}
else
{
    <div class="text-center p-8 text-white">Exam not found.</div>
}
